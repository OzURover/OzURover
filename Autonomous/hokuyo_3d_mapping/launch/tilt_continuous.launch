<!-- This launch file causes the Hokuyo to sweep back and forth CONTINUOUSLY -->

<launch>

  <node name="dynamixel_manager" pkg="dynamixel_controllers" type="controller_manager.py" output="screen">
    <rosparam>
      namespace: dxl_manager
      serial_ports:
        pan_tilt_port:
          port_name: "/dev/ttyUSB0"
          baud_rate: 57600
          min_motor_id: 2
          max_motor_id: 2
          update_rate: 60
    </rosparam>
  </node>

  <rosparam file="$(find spin_hokuyo)/launch/dynamixel_servos_tilting.yaml" command="load" />

  <node name="dynamixel_controller_spawner" pkg="dynamixel_controllers" type="controller_spawner.py"
        args="--manager=dxl_manager --port=pan_tilt_port --type=simple tilt_controller" output="screen" />

  <node name="tilt_motor" pkg="spin_hokuyo" type="tilt_motor" output="screen"/>

  <node name="tilt_transform" pkg="spin_hokuyo" type="tilt_transform" output="screen"/>

  <node name="urg_node" pkg="urg_node" type="urg_node" output="screen">
    <param name="ip_address" value="192.168.0.10"/>
  </node>

  <!-- <node name="hokuyo_robot_filter" pkg="spin_hokuyo" type="hokuyo_robot_filter" output="screen" /> -->

  <node name="scan_to_pcl" pkg="spin_hokuyo" type="scan_to_pcl" output="screen"/>

  <node type="point_cloud_assembler" pkg="laser_assembler"  name="pcl_assembler_server">
    <remap from="cloud" to="hokuyo_points"/>
    <param name="max_clouds" type="int" value="400" />
    <param name="fixed_frame" type="string" value="map" />
  </node>

  <node name="pcl_assembler_client" pkg="spin_hokuyo" type="pcl_assembler_client" output="screen" />

</launch>
